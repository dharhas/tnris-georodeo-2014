<!doctype html>
<html lang="en">    
<head>
    <meta charset="utf-8">
    <title>Python and GIS - Dharhas Pothina</title>
    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme"> 
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <!--Add support for earlier versions of Internet Explorer -->
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>
  <!-- Wrap the entire slide show in a div using the "reveal" class. -->
  <div class="reveal">
    <!-- Wrap all slides in a single "slides" class -->
    <div class="slides">
      <!-- ALL SLIDES GO HERE -->
      <!-- Each section element contains an individual slide -->
      <section data-background-transition="slide" data-background="media/python_swimming.jpg" style="background: rgba(0,129,195,.6); color: white" id="presentable" class="bookend">
        <h3> Python and GIS </h3>
        <h4> Dharhas Pothina </h4>
        <small> TNRIS GeoRodeo - May 30th, 2014</small>
      </section>
      
      <section>
        <section>
          <h1> Why </h1>
          <img src="media/python-logo.png">
        </section>
        <section>
          <h3>lets back up a minute ...</h3>
          <br>
          <p class="fragment roll-in"> Why Program? </p>
          <br>
          <p class="fragment roll-in"> What is wrong with ... </p>
        </section>
        <section>
          <h1> This? </h1>
            <img src="media/arcgis.jpg" height=400px>
        </section>
        <section>
          <h3>well nothing actually ...</h3>
          <p class="fragment roll-in">... until you hit a deadline</p>
          <p class="fragment roll-in">... and realize you made a mistake</p>
          <p class="fragment roll-in">... in one of the intermediate analysis steps </p>
          <p class="fragment roll-in">... three weeks ago </p>
        </section>
        <section>
          so again why Python?
        </section>
        <section>
          <h2>Because it is not a GIS tool</h2>
          <img src="media/swissarmy.jpg" height=400px>
        </section>
        <section>
          <h3>It is used in</h3>
          <p>
          <ul>
            <li> Web frameworks </li>
            <li> Data Visualization </li>
            <li> Image Processing </li>
            <li> Numerical Modeling </li>
            <li> Signal Processing </li>
            <li> Machine Learning </li>
            <li> Big Data </li>
            <li> Blah Blah Blah </li>
          </ul>
          </p>
          <br>
          <p>
            <h3 class="fragment roll-in"> Oh and also in GIS </h3>
          </p>
        </section>
        <section data-background-transition="slide" data-background="media/cartopy.png" style="background: rgba(0,129,195,.6); color: white" id="presentable" class="bookend">
          <h2> Some Python GIS tools </h2>
          <ul>
            <li class="fragment highlight-green"> PyProj </li>
            <li class="fragment highlight-green"> Fiona/Rasterio </li>
            <li class="fragment highlight-green"> Shapely </li>
            <li> Arcpy </li>
            <li> PySAL </li>
            <li> QGIS </li>
            <li> Matplotlib/Basemap </li>
            <li> Cartopy </li>
            <li> Numpy/Scipy Ecosystem</li>
          </ul>
        </section>
      </section>
      <section>
        <section data-background-transition="slide" data-background="media/projections.png" style="background: rgba(0,129,195,.6); color: white" id="presentable" class="bookend">
          Projections
        </section>
        <section>
          <h2>PyProj (PROJ.4)</h2>
          <ul>
            <li>generalized projection engine</li>
            <li>projections determined by: proj4 string or EPSG number</li>
            <li>UTM14 
<pre><code>EPSG number: 32614
proj4 string: '+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs'</code></pre>
            </li>
            <li>http://spatialreference.org, http://www.epsg-registry.org/</li>
          </ul>
        </section>
        <section>
          <p>Read csv data from url and project Travis County Cities to UTM14</p>
          <pre><code>"""
url - http://goo.gl/WFylXY
data format: 
  "zip_code","latitude","longitude","city","state","county"
  "00501",40.922326,-72.637078,"Holtsville","NY","Suffolk"
  "00544",40.922326,-72.637078,"Holtsville","NY","Suffolk"
  ...
"""
import pyproj
import pandas as pd
url = "http://goo.gl/WFylXY"
data = pd.read_csv(url)
travis_cities = data[data['county']=='Travis']
lons = travis_cities['longitude'].values
lats = travis_cities['latitude'].values
utm14 = pyproj.Proj("+init=EPSG:32614")
travis_cities['utm_x'], travis_cities['utm_y'] = utm14(lons, lats)
          </code></pre>
        </section>
      </section>
      <section>
        <section>
          <h1>GDAL and OGR</h1>
          <img src="media/gdal-geoid.jpg">
          <h2>fiona and rasterio</h2>
        </section>
        <section>
          <img src="media/toothbrushes.jpg">
          <p class="fragment roll-in"> <quote>Standards are like toothbrushes, everybody agrees you should have one, but no one wants to use yours. â€” Joe Croser</quote></p>
        </section>
        <section>
          Fiona/Shapely Example - Convert CSV to Shapefile
          <pre><code>import pandas as pd
from shapely.geometry import Point, mapping
from fiona import collection
 
schema = { 'geometry': 'Point', 'properties': { 'city': 'str', 'zip': 'str' } }
url = "http://goo.gl/WFylXY"
data = pd.read_csv(url)
with collection("zipcodes.shp", "w", "ESRI Shapefile", schema) as output:
    for index, row in data.iterrows():
        point = Point(row['longitude'], row['latitude'])
        output.write({
            'properties': {'city': row['city'], 'zip': row['zip_code']},
            'geometry': mapping(point)
        })
          </code></pre>
        </section>
        <section>
        <h4>ftp://rockyftp.cr.usgs.gov/vdelivery/Datasets/Staged/NED/1/</h4>
        <pre><code>print 'Downloading tiles needed for requested bounding box:'
raster_tiles = []
tiles = _tile_urls(layer, xmin, ymin, xmax, ymax)
for i, url in enumerate(tiles):
    filename = os.path.split(url)[-1]
    zip_path = os.path.join(path, layer_dict[layer], 'zip', filename)

    print '... downloading tile %s of %s from %s' % (i+1, len(tiles), url)
    util.download_if_new(url, zip_path, check_modified=True)
    print '... ... zipfile saved at %s' % zip_path
    tile_path = zip_path.replace('/zip', '')
    raster_tiles.append(_extract_raster_from_zip(zip_path, tile_path))

print 'Mosaic and clip to bounding box extents'
tile_path = os.path.split(tile_path)[0]
print subprocess.check_output(['gdalbuildvrt', '-te', repr(xmin), repr(ymin), repr(xmax), repr(ymax), output_path] + raster_tiles)
return output_path
        </code></pre>
        </section>
        <section>
        <pre><code>xmin, xmax, ymin, ymax = (-79.68433821243661, -77.42742156945509, 
        32.81417227179455, 34.998064728936754)
filename = get_raster('1 arc-second', xmin, ymin, xmax, ymax)
with rasterio.drivers():
    with rasterio.open(fname) as src:
        dem = src.read_band(1)
        ndv = src.nodatavals
dem[dem==ndv] = np.nan
plt.imshow(dem)
plt.savefig('dem.png')
        </code></pre>
        </section>
        <section>
          <img src="media/dem.png">
        </section>
      </section>
      <section>
        <section data-background-transition="slide" data-background="media/lego_globe.jpg" style="background: rgba(0,129,195,.6); color: white" id="presentable" class="bookend">
          Putting it all together
        </section>
        <section>
          <table>
            <td><img src="media/kl_interp.png"></td>
            <td><img src="media/leon_interp.png"></td>
          </table>
        </section>
        <section>
          <table>
            <td><img src="media/survey.png"></td>
            <td><img src="media/bad_lake_interp.png"></td>
          </table>
        </section>
        <section>
          <img src="media/aeidw_polygons.png">
          <h3>AEIDW - Anisotropic Eliptical Inverse Distance Weighting</h3>
        </section>
        <section>
          <img src="media/aeidw.png">
        </section>
      </section>
      <section>
        <img src="media/sliderule.jpg">
        <h2 class="fragment roll-in">Wean yourself from GUI reliance <br> Start Coding! </h2>
      </section>
      <section data-background-transition="slide" data-background="media/recent_conditions_bw.png" style="background: rgba(0,129,195,.6); color: white" id="presentable" class="bookend">
        <h2> Questions? </h2>
        <p>dharhas@gmail.com</p>
      </section>
    </div>
  </div>
  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.min.js"></script>

  <script>
      // Required, even if empty.
		  Reveal.initialize({
			controls: true,
			progress: true,
			// history: true,
			center: true,

			// Optional libraries used to extend on reveal.js
			dependencies: [
				{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
				{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
				{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
				{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
			]
		});
  </script>
</body>
</html>
